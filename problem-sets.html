<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Problem Sets - ThinkBigPrep</title>
    <link rel="stylesheet" href="css/index.css?v=1.1" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.6/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- Perseus dependencies (Khan Academy open-source) -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Light-weight stand-in: we’ll use a simplified renderer approach that emulates Perseus style -->
    <style>
      .ps-container{display:grid;grid-template-columns:280px 1fr;gap:24px;max-width:1200px;margin:140px auto 80px;padding:0 20px}
      .ps-sidebar{position:sticky;top:96px;height:calc(100vh - 140px);overflow:auto;border:1px solid #e5e7eb;border-radius:12px;padding:12px;background:#fff}
      .ps-section-title{font-size:1.1rem;font-weight:800;color:#8B4513;margin:8px 0 6px}
      .ps-lesson{display:flex;align-items:center;justify-content:space-between;border:1px solid #eee;border-radius:10px;padding:8px 10px;margin:6px 0;background:#F5E6D3;color:#6b3410;cursor:pointer}
      .ps-lesson .status{font-size:.75rem;background:#fff;border:1px solid #e5e7eb;border-radius:9999px;padding:2px 8px}
      .ps-lock{color:#6b3410;opacity:.8;margin-right:6px}
      .ps-progress{height:6px;background:#f3f4f6;border-radius:9999px;overflow:hidden;margin:8px 0}
      .ps-progress>div{height:100%;background:#8B4513}
      .ps-content{border:1px solid #e5e7eb;border-radius:12px;padding:18px;background:#fff}
      .ps-breadcrumb{color:#6b7280;font-size:.9rem;margin-bottom:6px}
      .ps-title{font-size:1.6rem;font-weight:800;color:#1a1a1a;margin:6px 0 10px}
      .ps-actions{display:flex;gap:8px;margin-bottom:12px}
      .ps-actions .btn{padding:10px 14px;border-radius:10px}
      .ps-body{line-height:1.7;color:#1a1a1a}
      @media(max-width:900px){.ps-container{grid-template-columns:1fr}.ps-sidebar{position:fixed;left:0;top:0;bottom:0;width:78%;max-width:360px;transform:translateX(-105%);transition:transform .3s ease;z-index:1200}.ps-sidebar.active{transform:translateX(0)}.ps-toggle{position:fixed;top:96px;left:10px;z-index:1300;background:#F5E6D3;color:#6b3410;border:none;border-radius:8px;padding:10px 12px;box-shadow:0 8px 20px rgba(0,0,0,.15)}}
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-container">
        <a href="index.html#home" class="logo" style="text-decoration:none;color:inherit;"><img src="./assets/logo/thinkbigprep-logo.svg" alt="ThinkBigPrep"/></a>
        <nav class="nav-desktop">
          <a href="index.html#home">Home</a>
          <a href="timetable.html">Timetable</a>
          <a href="index.html#courses">Plans</a>
          <a href="problem-sets.html" class="active">Problem Sets</a>
          <a href="ai-curriculum.html" class="ai-curriculum-link">AI Curriculum <span class="new-tag">NEW</span></a>
          <a href="login.html" class="student-login-link">Student Login</a>
        </nav>
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()"><i class="bi bi-list"></i></button>
      </div>
    </header>

    <section class="timetable-hero" style="padding:140px 0 40px;">
      <div class="container">
        <h1 class="timetable-title">Problem Sets</h1>
        <p class="timetable-subtitle">Interactive exercises powered by a Perseus-style renderer</p>
      </div>
    </section>

    <main class="ps-container">
      <button class="ps-toggle" aria-label="Toggle lessons" onclick="document.querySelector('.ps-sidebar').classList.toggle('active')"><i class="bi bi-list"></i> Lessons</button>
      <aside class="ps-sidebar" id="psSidebar"></aside>
      <section class="ps-content">
        <div class="ps-breadcrumb" id="psBreadcrumb">Algebra 1 / Lesson 1</div>
        <h2 class="ps-title" id="psTitle">Linear Equations — Basics</h2>
        <div class="ps-actions">
          <button class="btn btn-primary" id="psPracticeBtn">Practice</button>
          <button class="btn btn-secondary" id="psLiveBtn">Live Session</button>
        </div>
        <div class="ps-body" id="psBody">
          <p>Select a lesson from the left to begin.</p>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <div class="footer-logo"><img src="./assets/logo/thinkbigprep-logo.svg" alt="ThinkBigPrep"/><span>ThinkBigPrep</span></div>
          </div>
          <div class="footer-section">
            <h4>SEE ALSO</h4>
            <ul>
              <li><a href="index.html#home">Home</a></li>
              <li><a href="timetable.html">Timetable</a></li>
              <li><a href="ai-curriculum.html">AI Curriculum</a></li>
              <li><a href="problem-sets.html">Problem Sets</a></li>
            </ul>
          </div>
          <div class="footer-section"><h4>CONTACT US</h4><p>Phone: 201-665-0123</p><p>Email: info@thinkbigprep.com</p></div>
        </div>
        <div class="footer-bottom"><p>ThinkBigPrep © 2025</p></div>
      </div>
    </footer>

    <script>
      // Seed data (could be external JSON)
      const COURSES = [
        { id:'algebra-1', title:'Algebra 1', lessons:[
          { slug:'linear-equations-basics', title:'Linear Equations — Basics', locked:false, body:`# Linear Equations (Basics)\nSolve for x: 2x + 5 = 13.`, progress:0.2 },
          { slug:'slope-intercept', title:'Slope-Intercept Form', locked:false, body:`# Slope-Intercept\nThe form is y = mx + b.`, progress:0.0 },
          { slug:'systems', title:'Systems of Equations', locked:true, body:`# Systems of Equations\nLocked preview.`, progress:0.0 },
        ]},
        { id:'algebra-2', title:'Algebra 2', lessons:[
          { slug:'quadratics', title:'Quadratics', locked:false, body:`# Quadratics\nComplete the square.`, progress:0.0 },
        ]},
        { id:'geometry', title:'Geometry', lessons:[
          { slug:'triangles', title:'Triangles', locked:false, body:`# Triangles\nBasic triangle properties.`, progress:0.0 },
        ]},
        { id:'precalculus', title:'Pre-Calculus', lessons:[
          { slug:'functions', title:'Functions', locked:false, body:`# Functions\nDomain and range.`, progress:0.0 },
        ]},
        { id:'calculus', title:'Calculus', lessons:[
          { slug:'derivatives', title:'Derivatives', locked:false, body:`# Derivatives\nThe derivative measures rate of change.`, progress:0.0 },
        ]},
      ];

      function saveProgress(key, value){ try { localStorage.setItem(key, JSON.stringify(value)); } catch{} }
      function getProgress(key, fallback){ try { const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; } catch{ return fallback; } }

      function renderSidebar(){
        const root = document.getElementById('psSidebar');
        root.innerHTML = '';
        COURSES.forEach(course => {
          const h = document.createElement('div'); h.className='ps-section-title'; h.textContent = course.title; root.appendChild(h);
          const progKey = `ps-progress-${course.id}`;
          const progVal = getProgress(progKey, 0);
          const bar = document.createElement('div'); bar.className='ps-progress'; bar.innerHTML = `<div style="width:${Math.round(progVal*100)}%"></div>`; root.appendChild(bar);
          course.lessons.forEach(lesson => {
            const row = document.createElement('div'); row.className='ps-lesson'; row.dataset.slug = `${course.id}/${lesson.slug}`;
            const left = document.createElement('div');
            left.style.display='inline-flex'; left.style.alignItems='center';
            if (lesson.locked) { const i=document.createElement('i'); i.className='bi bi-lock ps-lock'; left.appendChild(i); }
            const t=document.createElement('span'); t.textContent=lesson.title; left.appendChild(t);
            const right = document.createElement('div'); right.className='status'; right.textContent = lesson.locked? 'Locked' : (lesson.progress>0? 'In Progress':'Start');
            row.appendChild(left); row.appendChild(right);
            row.addEventListener('click', ()=> loadLesson(course.id, lesson.slug));
            root.appendChild(row);
          });
        });
      }

      function mdToHtml(md){
        return md
          .replace(/^# (.*)$/gm, '<h3>$1</h3>')
          .replace(/^## (.*)$/gm, '<h4>$1</h4>')
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\n/g, '<br/>');
      }

      function loadLesson(courseId, slug){
        const course = COURSES.find(c=>c.id===courseId);
        if (!course) return;
        const lesson = course.lessons.find(l=>l.slug===slug);
        if (!lesson || lesson.locked) return;
        document.getElementById('psBreadcrumb').textContent = `${course.title} / ${lesson.title}`;
        document.getElementById('psTitle').textContent = lesson.title;
        document.getElementById('psBody').innerHTML = mdToHtml(lesson.body);
        // mark some progress
        lesson.progress = Math.max(lesson.progress, 0.25);
        saveProgress(`ps-progress-${courseId}`, averageProgress(course.lessons));
        renderSidebar();
        // default actions
        document.getElementById('psPracticeBtn').onclick = ()=> alert('Practice coming soon.');
        document.getElementById('psLiveBtn').onclick = ()=> window.location.href = 'timetable.html';
      }

      function averageProgress(arr){
        if (!arr.length) return 0;
        return arr.reduce((s,l)=> s + (l.progress||0), 0) / arr.length;
      }

      // Initialize
      renderSidebar();
      // default to first lesson
      try { const c=COURSES[0]; if (c) loadLesson(c.id, c.lessons[0].slug); } catch{}
    </script>
    <script src="index.js"></script>
  </body>
  </html>


